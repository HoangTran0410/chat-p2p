import{r as l,j as e,h as ee,A as I,U as te,M as se,i as B,a as v,X as R,P as ae,b as Re,c as M,d as Me,R as h,G as Ee,k as le,I as Fe,l as E,m as u,n as re,o as ie,p as $e,q as Te,s as De,T as Ae,F as ze}from"../vendor-D-SuBDzD.js";import{M as Le,F as Ue}from"../index-Crz8AdiB.js";import{g as Be}from"../services/storage-zbee7ku7.js";const Ge=({myId:a,peerId:d,session:s,connectionState:i,onSendMessage:o,onDeleteChat:f,onBack:x,onConnect:m,onCancelConnection:ne,isReady:P,activeConnectionsCount:ce,totalChats:de,isPeerTyping:W=!1,onTyping:b,peerError:F,onRetry:oe,onRandomId:xe,onUpdateId:me,onRenameChat:he,onResendMessage:ue,onRequestSync:pe,onSendFileChunked:O,sendingProgress:$,receivingProgress:y})=>{const[j,_]=l.useState(""),[K,G]=l.useState(!1),[fe,T]=l.useState(!1),[C,H]=l.useState(""),[X,be]=l.useState(null),[k,Z]=l.useState(!1),[je,D]=l.useState(!1),[q,V]=l.useState(""),Y=l.useRef(null),p=l.useRef(null),[S,A]=l.useState(null),[ge,z]=l.useState(!1),g=l.useRef(null),N=l.useRef(!1),Ne=()=>{var t;(t=Y.current)==null||t.scrollIntoView({behavior:"smooth"})};l.useEffect(()=>{Ne()},[s==null?void 0:s.messages,W]);const we=t=>{const r=t.target.value;_(r),b&&i==="connected"&&(N.current||(N.current=!0,b(!0)),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{N.current=!1,b(!1)},2e3))},J=t=>{t.preventDefault(),j.trim()&&(o(j),_(""),g.current&&clearTimeout(g.current),N.current&&b&&(N.current=!1,b(!1)))},ve=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),J(t))},ye=()=>{navigator.clipboard.writeText(a),G(!0),setTimeout(()=>G(!1),2e3)},Ce=async t=>{var c;const r=(c=t.target.files)==null?void 0:c[0];if(r){if(r.size>Le){A(r),z(!0),p.current&&(p.current.value="");return}await Q(r),p.current&&(p.current.value="")}},Q=async t=>{let r="file";if(t.type.startsWith("image/")?r="image":t.type.startsWith("video/")&&(r="video"),O&&t.size>Ue*2){const U=Be();O(U,t,r);return}const c=await t.arrayBuffer(),L={type:r,content:t.name,file:{name:t.name,size:t.size,mimeType:t.type,data:c}};o(L)},ke=async()=>{S&&(await Q(S),A(null)),z(!1)},Se=()=>{A(null),z(!1)},Ie=()=>{var t;(t=p.current)==null||t.click()};if(!d)return e.jsx("div",{className:"flex-1 flex flex-col h-full bg-slate-950 overflow-y-auto",children:e.jsxs("div",{className:"flex-1 p-6 md:p-12 max-w-5xl mx-auto w-full flex flex-col gap-8",children:[e.jsx("div",{className:"md:hidden flex items-center mb-2",children:e.jsxs("button",{onClick:x,className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[e.jsx(ee,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Back to Chats"})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Overview"}),e.jsx("p",{className:"text-slate-400",children:"Manage your secure P2P connections and identity."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-900 border border-slate-800 p-5 rounded-xl flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${P?"bg-green-500/10 text-green-500":"bg-yellow-500/10 text-yellow-500"}`,children:e.jsx(I,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Network Status"}),e.jsx("div",{className:"font-semibold text-lg text-slate-100",children:P?"Online":"Connecting..."})]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 p-5 rounded-xl flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-500/10 text-blue-500",children:e.jsx(te,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Active Sessions"}),e.jsx("div",{className:"font-semibold text-lg text-slate-100",children:ce})]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 p-5 rounded-xl flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-purple-500/10 text-purple-500",children:e.jsx(se,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Total Conversations"}),e.jsx("div",{className:"font-semibold text-lg text-slate-100",children:de})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-slate-900 to-slate-800 border border-slate-700 rounded-2xl p-6 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-32 bg-primary-600/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 group-hover:bg-primary-600/20 transition-all duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h3",{className:"text-lg font-medium text-white mb-4 flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-primary-400"}),"Your Digital Identity"]}),fe?e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("input",{type:"text",value:C,onChange:t=>H(t.target.value),className:"flex-1 text-xl font-mono bg-slate-950 border border-slate-600 rounded-lg px-4 py-2 text-white focus:border-primary-500 outline-none",autoFocus:!0}),e.jsxs("button",{onClick:()=>{C&&/^[a-zA-Z0-9-_]+$/.test(C)&&(me(C),T(!1))},className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-500 rounded-lg text-sm font-medium transition-colors text-white",children:[e.jsx(v,{className:"w-4 h-4"}),"Save"]}),e.jsxs("button",{onClick:()=>T(!1),className:"flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm font-medium transition-colors text-slate-200",children:[e.jsx(R,{className:"w-4 h-4"}),"Cancel"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("code",{className:"block text-2xl md:text-3xl font-mono text-white tracking-tight break-all mb-4",children:a||"Generating ID..."}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>{H(a),T(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-600 rounded-lg text-sm font-medium transition-colors text-slate-200",children:[e.jsx(ae,{className:"w-4 h-4"}),"Edit ID"]}),e.jsxs("button",{onClick:xe,className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-600 rounded-lg text-sm font-medium transition-colors text-slate-200",children:[e.jsx(Re,{className:"w-4 h-4"}),"New ID"]}),e.jsxs("button",{onClick:ye,className:"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 border border-slate-600 rounded-lg text-sm font-medium transition-colors text-slate-200",children:[K?e.jsx(M,{className:"w-4 h-4 text-green-400"}):e.jsx(Me,{className:"w-4 h-4"}),K?"Copied":"Copy ID"]}),F&&e.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-4 py-2 bg-primary-600/20 hover:bg-primary-600/30 border border-primary-500/30 rounded-lg text-sm font-medium transition-colors text-primary-400",children:[e.jsx(h,{className:"w-4 h-4"}),"Retry"]})]})]}),F&&e.jsx("div",{className:"mt-3 text-sm text-red-400 font-medium",children:F}),e.jsx("p",{className:"mt-4 text-sm text-slate-400 max-w-2xl",children:"This ID allows others to connect with you securely. Share it only with trusted peers. Connections are established directly between devices."})]})]}),e.jsxs("div",{className:"mt-auto grid grid-cols-1 sm:grid-cols-3 gap-6 text-xs text-slate-500 border-t border-slate-800 pt-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:"End-to-End Encrypted Transport"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{children:"Serverless Architecture"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"WebRTC P2P Protocol"})]})]})]})});const w=(()=>{switch(i){case"connected":return{color:"bg-green-500",text:"Connected",subtext:"End-to-end encrypted",icon:e.jsx(B,{className:"w-3 h-3"})};case"connecting":return{color:"bg-yellow-500 animate-pulse",text:"Connecting...",subtext:"Waiting for peer response",icon:e.jsx(I,{className:"w-3 h-3 animate-spin"})};case"failed":return{color:"bg-red-500",text:"Connection Failed",subtext:"Peer offline or not found",icon:e.jsx(E,{className:"w-3 h-3"})};default:return{color:"bg-slate-600",text:"Disconnected",subtext:"Session offline",icon:e.jsx(le,{className:"w-3 h-3"})}}})(),n=i==="connected";return e.jsxs("div",{className:"flex-1 flex h-full bg-slate-950 relative",children:[e.jsxs("div",{className:`flex-1 flex flex-col min-w-0 ${k?"hidden md:flex":"flex"}`,children:[e.jsxs("div",{className:"h-16 border-b border-slate-800 flex items-center justify-between px-4 bg-slate-950/80 backdrop-blur-sm z-10 sticky top-0",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("button",{onClick:x,className:"md:hidden p-2 -ml-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(ee,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("h2",{className:"font-semibold text-slate-100 flex items-center gap-2 truncate text-base",children:e.jsx("span",{className:`${s!=null&&s.name?"font-sans":"font-mono tracking-wide"} truncate`,children:(s==null?void 0:s.name)||d})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${w.color}`}),e.jsxs("span",{className:`${i==="failed"?"text-red-400":"text-slate-400"} flex items-center gap-1.5`,children:[(s==null?void 0:s.name)&&e.jsx("span",{className:"text-slate-500 font-mono tracking-tight mr-1 border-r border-slate-800 pr-2",children:d}),w.text]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pl-2",children:[i==="connecting"&&e.jsxs("button",{onClick:ne,className:"px-3 py-1.5 bg-slate-800 hover:bg-slate-700 text-slate-300 text-xs font-medium rounded-lg transition-colors flex items-center gap-1.5",children:[e.jsx(le,{className:"w-3.5 h-3.5"}),"Cancel"]}),(i==="failed"||i==="disconnected")&&e.jsxs("button",{onClick:m,className:"px-3 py-1.5 bg-primary-600/20 hover:bg-primary-600/30 text-primary-400 text-xs font-medium rounded-lg transition-colors flex items-center gap-1.5",children:[e.jsx(h,{className:"w-3.5 h-3.5"}),"Reconnect"]}),e.jsx("button",{onClick:()=>Z(!k),className:`p-2 rounded-lg transition-colors ${k?"text-primary-400 bg-primary-600/20":"text-slate-400 hover:text-white hover:bg-slate-800"}`,title:"Conversation Info",children:e.jsx(Fe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:x,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors hidden md:block",title:"Close Chat",children:e.jsx(R,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[!s||s.messages.length===0?e.jsx("div",{className:"h-full flex flex-col items-center justify-center text-slate-600 text-sm p-4 text-center",children:i==="connecting"?e.jsxs("div",{className:"flex flex-col items-center gap-3 animate-pulse",children:[e.jsx(I,{className:"w-8 h-8 text-primary-500 opacity-50"}),e.jsx("p",{children:"Establishing secure connection..."})]}):i==="failed"?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(E,{className:"w-8 h-8 text-red-500 opacity-50"}),e.jsx("p",{className:"text-red-400/80",children:"Could not connect to peer."}),e.jsx("button",{onClick:m,className:"text-primary-500 hover:underline",children:"Try Again"})]}):e.jsx("p",{children:"No messages yet. Say hello!"})}):s.messages.map((t,r)=>{const c=t.senderId===a,L=r===0||t.timestamp-s.messages[r-1].timestamp>3e5;return e.jsxs("div",{className:"space-y-2",children:[L&&e.jsx("div",{className:"flex justify-center my-4",children:e.jsx("span",{className:"text-[10px] text-slate-600 bg-slate-900/50 px-2 py-0.5 rounded-full border border-slate-800",children:u(t.timestamp,"MMM d, h:mm a")})}),e.jsxs("div",{className:`flex flex-col ${c?"items-end":"items-start"}`,children:[e.jsxs("div",{onClick:()=>be(X===t.id?null:t.id),className:`max-w-[85%] sm:max-w-[75%] px-4 py-2.5 rounded-2xl text-sm leading-relaxed shadow-sm break-words cursor-pointer transition-all hover:opacity-90 ${c?"bg-primary-600 text-white rounded-br-sm":"bg-slate-800 text-slate-200 border border-slate-700 rounded-bl-sm"}`,children:[e.jsx(Pe,{message:t}),e.jsxs("div",{className:`text-[10px] mt-1 flex items-center gap-1 ${c?"text-primary-200":"text-slate-500"}`,children:[u(t.timestamp,"h:mm a"),c&&t.status&&e.jsxs("span",{className:"ml-1",children:[t.status==="read"&&e.jsx(re,{className:"w-3 h-3"}),t.status==="delivered"&&e.jsx(M,{className:"w-3 h-3"}),t.status==="sent"&&e.jsx(M,{className:"w-3 h-3 opacity-50"}),t.status==="failed"&&e.jsx(E,{className:"w-3 h-3 text-red-200"})]})]})]}),c&&t.status==="failed"&&e.jsxs("button",{onClick:U=>{U.stopPropagation(),ue(t.id)},className:"text-xs text-red-400 hover:text-red-300 flex items-center gap-1 mt-1 px-1 transition-colors",children:[e.jsx(h,{className:"w-3 h-3"}),"Tap to retry"]}),X===t.id&&e.jsxs("div",{className:`mt-1 px-3 py-2 rounded-lg bg-slate-900 border border-slate-800 text-xs space-y-1 max-w-[85%] ${c?"mr-0":"ml-0"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(ie,{className:"w-3 h-3"}),e.jsxs("span",{children:["Sent:"," ",u(t.timestamp,"MMM d, yyyy h:mm:ss a")]})]}),t.receivedAt&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(M,{className:"w-3 h-3"}),e.jsxs("span",{children:["Delivered: ",u(t.receivedAt,"h:mm:ss a")]})]}),t.readAt&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(re,{className:"w-3 h-3"}),e.jsxs("span",{children:["Read: ",u(t.readAt,"h:mm:ss a")]})]})]})]})]},t.id)}),W&&e.jsx("div",{className:"flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl rounded-bl-sm px-4 py-3 flex items-center gap-1 w-fit",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce [animation-delay:-0.3s]"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce [animation-delay:-0.15s]"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce"})]})}),e.jsx("div",{ref:Y})]}),e.jsx("div",{className:"p-3 sm:p-4 border-t border-slate-800 bg-slate-950 safe-area-bottom",children:e.jsxs("form",{onSubmit:J,className:`relative flex items-end gap-2 p-2 rounded-xl border ${n?"border-slate-700 bg-slate-900 focus-within:border-primary-500/50 focus-within:ring-1 focus-within:ring-primary-500/50":"border-slate-800 bg-slate-900/50 opacity-75"} transition-all`,children:[e.jsx("input",{type:"file",ref:p,onChange:Ce,className:"hidden"}),e.jsx("button",{type:"button",onClick:Ie,disabled:!n,className:`p-2.5 rounded-lg mb-0.5 transition-all text-slate-400 hover:text-white hover:bg-slate-800 ${n?"":"cursor-not-allowed opacity-50"}`,title:"Attach File",children:e.jsx($e,{className:"w-5 h-5"})}),e.jsx("textarea",{value:j,onChange:we,onKeyDown:ve,disabled:!n,placeholder:n?"Type a message...":`Status: ${w.text}`,className:"flex-1 bg-transparent border-none focus:ring-0 text-slate-200 placeholder-slate-500 resize-none py-2.5 px-2 max-h-32 text-sm disabled:opacity-50 outline-none",rows:1,style:{minHeight:"44px"}}),e.jsx("button",{type:"submit",disabled:!j.trim()||!n,className:`p-2.5 rounded-lg mb-0.5 transition-all ${j.trim()&&n?"bg-primary-600 text-white hover:bg-primary-500 shadow-lg shadow-primary-900/20":"bg-slate-800 text-slate-500 cursor-not-allowed"}`,children:e.jsx(Te,{className:"w-5 h-5"})})]})})]}),k&&e.jsxs("div",{className:"w-full md:w-80 border-l border-slate-800 bg-slate-900 flex flex-col overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Conversation Info"}),e.jsx("button",{onClick:()=>Z(!1),className:"p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors md:hidden",children:e.jsx(R,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"p-4 border-b border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${n?"bg-green-500/20":"bg-slate-700"}`,children:e.jsx(te,{className:`w-6 h-6 ${n?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[je?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:q,onChange:t=>V(t.target.value),className:"flex-1 bg-slate-800 border border-slate-600 rounded px-2 py-1 text-sm text-white focus:border-primary-500 outline-none",placeholder:"Enter nickname...",autoFocus:!0}),e.jsx("button",{onClick:()=>{he(q),D(!1)},className:"p-1 bg-primary-600 hover:bg-primary-500 text-white rounded",children:e.jsx(v,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>D(!1),className:"p-1 bg-slate-700 hover:bg-slate-600 text-white rounded",children:e.jsx(R,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-white truncate",children:(s==null?void 0:s.name)||"Peer"}),e.jsx("button",{onClick:()=>{V((s==null?void 0:s.name)||""),D(!0)},className:"p-1 text-slate-400 hover:text-white hover:bg-slate-700 rounded transition-colors",title:"Edit name",children:e.jsx(ae,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"text-xs text-slate-400 font-mono truncate",children:d})]})]}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${n?"bg-green-500/20 text-green-400":"bg-slate-700 text-slate-400"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${w.color}`}),w.text]})]}),e.jsxs("div",{className:"p-4 border-b border-slate-800 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-400 flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"Total Messages"]}),e.jsx("span",{className:"text-white font-medium",children:(s==null?void 0:s.messages.length)||0})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-400 flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4"}),"First Message"]}),e.jsx("span",{className:"text-white font-medium",children:s!=null&&s.messages[0]?u(s.messages[0].timestamp,"MMM d, yyyy"):"-"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-400 flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),"Last Activity"]}),e.jsx("span",{className:"text-white font-medium",children:s!=null&&s.lastUpdated?u(s.lastUpdated,"MMM d, h:mm a"):"-"})]})]}),e.jsxs("div",{className:"p-4 space-y-2",children:[n&&e.jsxs("button",{onClick:pe,className:"w-full py-2.5 px-4 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm font-medium",children:[e.jsx(h,{className:"w-4 h-4"}),"Sync History"]}),!n&&e.jsxs("button",{onClick:m,className:"w-full py-2.5 px-4 bg-primary-600 hover:bg-primary-500 text-white rounded-lg flex items-center justify-center gap-2 transition-colors text-sm font-medium",children:[e.jsx(h,{className:"w-4 h-4"}),"Reconnect"]}),e.jsxs("button",{onClick:f,className:"w-full py-2.5 px-4 bg-red-950/50 hover:bg-red-950 text-red-400 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm font-medium",children:[e.jsx(Ae,{className:"w-4 h-4"}),"Delete Conversation"]})]})]}),ge&&S&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl p-6 max-w-sm w-full shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-500/20 rounded-full flex items-center justify-center",children:e.jsx(E,{className:"w-6 h-6 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Large File"}),e.jsxs("p",{className:"text-sm text-slate-400",children:[(S.size/1024/1024).toFixed(1)," MB"]})]})]}),e.jsx("p",{className:"text-slate-300 mb-6 text-sm",children:"This file is larger than 50MB. Sending large files may take a while and could fail on slow connections."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Se,className:"flex-1 py-2.5 bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:ke,className:"flex-1 py-2.5 bg-primary-600 hover:bg-primary-500 text-white rounded-lg transition-colors",children:"Send Anyway"})]})]})}),$&&e.jsxs("div",{className:"fixed bottom-24 left-1/2 -translate-x-1/2 bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 shadow-xl z-40 flex items-center gap-3 min-w-[200px]",children:[e.jsx("div",{className:"animate-spin",children:e.jsx(h,{className:"w-4 h-4 text-primary-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Sending file..."}),e.jsx("div",{className:"h-1.5 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-500 transition-all duration-200",style:{width:`${$.progress}%`}})})]}),e.jsxs("span",{className:"text-sm font-medium text-white",children:[$.progress,"%"]})]}),y&&e.jsxs("div",{className:"fixed bottom-24 left-1/2 -translate-x-1/2 bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 shadow-xl z-40 flex items-center gap-3 min-w-[200px]",children:[e.jsx("div",{className:"animate-spin",children:e.jsx(h,{className:"w-4 h-4 text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-xs text-slate-400 mb-1 truncate max-w-[120px]",children:["Receiving: ",y.fileName]}),e.jsx("div",{className:"h-1.5 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 transition-all duration-200",style:{width:`${y.progress}%`}})})]}),e.jsxs("span",{className:"text-sm font-medium text-white",children:[y.progress,"%"]})]})]})},Pe=({message:a})=>{const[d,s]=l.useState(null);l.useEffect(()=>{var o;if((o=a.file)!=null&&o.data&&(a.type==="image"||a.type==="video")){const f=a.file.data instanceof Blob?a.file.data:new Blob([a.file.data]),x=URL.createObjectURL(f);return s(x),()=>URL.revokeObjectURL(x)}},[a]);const i=o=>{if(o==null||o.stopPropagation(),!a.file)return;const f=a.file.data instanceof Blob?a.file.data:new Blob([a.file.data]),x=URL.createObjectURL(f),m=document.createElement("a");m.href=x,m.download=a.file.name,m.click(),URL.revokeObjectURL(x)};return a.type==="image"&&d?e.jsxs("div",{className:"mb-2 max-w-sm relative group",children:[e.jsx("img",{src:d,alt:a.content,className:"rounded-lg border border-slate-700 w-full h-auto object-contain"}),e.jsx("button",{onClick:i,className:"absolute top-2 right-2 p-1.5 bg-black/50 hover:bg-black/70 text-white rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"Download",children:e.jsx("div",{className:"w-4 h-4",children:e.jsx(v,{className:"w-4 h-4"})})})]}):a.type==="video"&&d?e.jsxs("div",{className:"mb-2 max-w-sm relative group",children:[e.jsx("video",{src:d,controls:!0,className:"rounded-lg border border-slate-700 w-full"}),e.jsx("button",{onClick:i,className:"absolute top-2 right-2 p-1.5 bg-black/50 hover:bg-black/70 text-white rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"Download",children:e.jsx("div",{className:"w-4 h-4",children:e.jsx(v,{className:"w-4 h-4"})})})]}):a.type==="file"&&a.file?e.jsxs("div",{className:"mb-2 p-3 bg-slate-800 border border-slate-700 rounded-lg flex items-center gap-3 w-fit hover:bg-slate-750 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(ze,{className:"w-5 h-5 text-primary-400"})}),e.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-200 truncate max-w-[150px]",children:a.file.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:[(a.file.size/1024).toFixed(1)," KB"]})]}),e.jsx("button",{onClick:i,className:"p-1.5 text-slate-400 hover:text-white hover:bg-slate-600 rounded",title:"Download",children:e.jsx(v,{className:"w-4 h-4"})})]}):e.jsx("div",{className:"text-sm border-b border-slate-800/50 pb-2 mb-2 whitespace-pre-wrap",children:a.content})};export{Ge as C};
