import{r as t,j as e,M as G,L as K,S as O,C as X,a as Y,X as Z,P as _,b as H,c as J,d as Q,R as W,e as ee,f as se,g as te}from"../vendor-B6XYtufB.js";const le=({myId:a,chats:I,activeConnections:k,selectedPeerId:S,onSelectPeer:b,onConnect:D,onUpdateId:P,onRenameChat:R,onShowDashboard:F,peerError:i,isReady:$,onRetry:A,onRandomId:E,onOpenSettings:T})=>{const[o,g]=t.useState(""),[M,f]=t.useState(!1),[U,x]=t.useState(!1),[m,c]=t.useState(!1),[r,u]=t.useState(""),[p,h]=t.useState(null),[j,N]=t.useState("");t.useEffect(()=>{m||u(a)},[a,m]);const V=()=>{navigator.clipboard.writeText(a),f(!0),setTimeout(()=>f(!1),2e3)},z=s=>{s.preventDefault(),o&&o!==a&&(D(o),g(""),x(!1))},L=()=>{r&&r!==a?/^[a-zA-Z0-9-_]+$/.test(r)?(P(r),c(!1)):alert("ID can only contain letters, numbers, hyphens, and underscores."):c(!1)},q=(s,l)=>{s.stopPropagation(),h(l.peerId),N(l.name||l.peerId)},v=s=>{s==null||s.preventDefault(),p&&(R(p,j),h(null))},B=s=>{h(null)},w=Object.values(I).sort((s,l)=>l.lastUpdated-s.lastUpdated);return e.jsxs("div",{className:"w-full h-full bg-slate-900 border-r border-slate-800 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800 bg-slate-900/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h1",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(G,{className:"w-6 h-6 text-primary-500"}),"Ping"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:F,className:"md:hidden p-2 text-slate-400 hover:text-white bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors",title:"View Dashboard",children:e.jsx(K,{className:"w-5 h-5"})}),e.jsx("button",{onClick:T,className:"p-2 text-slate-400 hover:text-white bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors",title:"Connection Settings",children:e.jsx(O,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg p-3",children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:`w-2 h-2 ${i?"fill-red-500 text-red-500":$?"fill-green-500 text-green-500":"fill-yellow-500 text-yellow-500"}`}),e.jsx("span",{className:"text-xs text-slate-400",children:"Your ID"})]})}),m?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r,onChange:s=>u(s.target.value),className:"flex-1 bg-slate-950 border border-slate-700 rounded px-2 py-1 text-sm text-white focus:border-primary-500 outline-none",autoFocus:!0}),e.jsx("button",{onClick:L,className:"p-1.5 bg-primary-600 hover:bg-primary-500 text-white rounded",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>c(!1),className:"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded",children:e.jsx(Z,{className:"w-4 h-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("code",{className:"block text-sm text-slate-200 truncate font-mono bg-slate-950 p-1.5 rounded border border-slate-700 select-all",children:a||"Initializing..."}),e.jsxs("div",{className:"mt-2 flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{u(a),c(!0)},className:"p-1.5 hover:bg-slate-700 rounded-md transition-colors text-slate-400 hover:text-white",title:"Edit ID",children:e.jsx(_,{className:"w-4 h-4"})}),e.jsx("button",{onClick:E,className:"p-1.5 hover:bg-slate-700 rounded-md transition-colors text-slate-400 hover:text-white",title:"Generate New ID",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx("button",{onClick:V,className:"p-1.5 hover:bg-slate-700 rounded-md transition-colors text-slate-400 hover:text-white",title:"Copy ID",children:M?e.jsx(J,{className:"w-4 h-4 text-green-500"}):e.jsx(Q,{className:"w-4 h-4"})}),i&&e.jsx("button",{onClick:A,className:"p-1.5 hover:bg-slate-700 rounded-md transition-colors text-primary-400 hover:text-primary-300",title:"Retry Connection",children:e.jsx(W,{className:"w-4 h-4"})})]})]}),i&&e.jsx("div",{className:"mt-2 text-xs text-red-400 font-medium",children:i})]})]}),e.jsx("div",{className:"p-4",children:U?e.jsxs("form",{onSubmit:z,className:"space-y-2 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx("input",{type:"text",value:o,onChange:s=>g(s.target.value),placeholder:"Paste Peer ID...",className:"w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-primary-500 transition-colors",autoFocus:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-primary-600 hover:bg-primary-500 text-white py-1.5 rounded text-sm font-medium",children:"Connect"}),e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-3 bg-slate-800 hover:bg-slate-700 text-slate-300 py-1.5 rounded text-sm",children:"Cancel"})]})]}):e.jsxs("button",{onClick:()=>x(!0),className:"w-full py-2.5 px-4 bg-primary-600 hover:bg-primary-500 text-white rounded-lg flex items-center justify-center gap-2 transition-all font-medium shadow-lg shadow-primary-900/20",children:[e.jsx(ee,{className:"w-4 h-4"}),"New Chat"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx("div",{className:"px-4 pb-2 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Conversations"}),w.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-500 text-sm",children:[e.jsx("p",{children:"No chats yet."}),e.jsx("p",{className:"mt-2 text-xs opacity-60",children:"Share your ID or enter a friend's ID to start."})]}):e.jsx("ul",{className:"space-y-1 px-2",children:w.map(s=>{const l=k.includes(s.peerId),y=S===s.peerId,d=s.messages[s.messages.length-1],C=p===s.peerId;return e.jsx("li",{children:e.jsxs("div",{className:`w-full text-left p-3 rounded-lg transition-all flex items-center gap-3 relative group ${y?"bg-slate-800 border border-slate-700 shadow-sm":"hover:bg-slate-800/50 border border-transparent"}`,children:[e.jsxs("button",{onClick:()=>b(s.peerId),className:"relative shrink-0",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold ${y?"bg-primary-600 text-white":"bg-slate-700 text-slate-300"}`,children:(s.name||s.peerId).slice(0,2).toUpperCase()}),l&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 border-2 border-slate-900 rounded-full"})]}),e.jsx("div",{className:"flex-1 min-w-0",onClick:()=>!C&&b(s.peerId),children:C?e.jsx("form",{onSubmit:v,className:"flex items-center gap-2",onClick:n=>n.stopPropagation(),children:e.jsx("input",{autoFocus:!0,value:j,onChange:n=>N(n.target.value),onBlur:()=>v(),onKeyDown:n=>{n.key==="Escape"&&B()},className:"w-full bg-slate-950 border border-primary-500/50 rounded px-1.5 py-0.5 text-sm text-white focus:outline-none"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-baseline mb-0.5",children:[e.jsx("span",{className:`font-medium text-slate-200 truncate text-sm cursor-pointer ${s.name?"":"font-mono"}`,children:s.name||s.peerId}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0 ml-2",children:[e.jsx("button",{onClick:n=>q(n,s),className:"hidden md:block text-slate-500 hover:text-primary-400 opacity-0 group-hover:opacity-100 transition-opacity",title:"Rename Contact",children:e.jsx(se,{className:"w-3 h-3"})}),d&&e.jsx("span",{className:"text-[10px] text-slate-500",children:te(d.timestamp,{addSuffix:!1}).replace("about ","")})]})]}),e.jsx("div",{className:"text-xs text-slate-400 truncate h-4 cursor-pointer",children:d?d.content:e.jsx("span",{className:"italic opacity-50",children:"No messages"})})]})})]})},s.peerId)})})]})]})};export{le as C};
