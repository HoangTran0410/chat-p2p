import{r as n,j as e,e as E,U as o,d as c,C as w,a as D,y as U,X as v,n as y,s as K,w as z}from"../vendor-CwijfaBe.js";import{a as H}from"../index-BBT-p0S5.js";const V=({myId:x,room:t,onSendMessage:C,onLeaveRoom:k,onBack:h,isHost:i})=>{const[r,p]=n.useState(""),[d,u]=n.useState(!1),[m,f]=n.useState(!1),b=n.useRef(null),I=()=>{var s;(s=b.current)==null||s.scrollIntoView({behavior:"smooth"})};n.useEffect(()=>{I()},[t.messages]);const j=s=>{s.preventDefault(),r.trim()&&(C(t.roomId,r.trim()),p(""))},S=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),j(s))},g=()=>{const s=H(t.roomId);navigator.clipboard.writeText(s),f(!0),setTimeout(()=>f(!1),2e3)},L=t.members.filter(s=>s.isOnline).length,$=s=>{if(s===x)return"You";const l=t.members.find(a=>a.peerId===s);return(l==null?void 0:l.name)||s.slice(0,8)};return e.jsxs("div",{className:"flex-1 flex h-full bg-slate-950",children:[e.jsxs("div",{className:`flex-1 flex flex-col min-w-0 ${d?"hidden md:flex":"flex"}`,children:[e.jsxs("div",{className:"h-16 border-b border-slate-800 flex items-center justify-between px-4 bg-slate-950/80 backdrop-blur-sm z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("button",{onClick:h,className:"md:hidden p-2 -ml-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(E,{className:"w-5 h-5"})}),e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-600 flex items-center justify-center",children:e.jsx(o,{className:"w-5 h-5 text-white"})}),i&&e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-yellow-500 border-2 border-slate-950 rounded-full flex items-center justify-center",children:e.jsx(c,{className:"w-2.5 h-2.5 text-slate-900"})})]}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("h2",{className:"font-semibold text-slate-100 truncate text-base",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),L]}),e.jsx("span",{className:"text-slate-600",children:"/"}),e.jsx("span",{children:t.members.length}),i&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-slate-600",children:"â€¢"}),e.jsxs("span",{className:"text-yellow-500 flex items-center gap-1",children:[e.jsx(c,{className:"w-3 h-3"}),"Host"]})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:g,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",title:"Share Invite Link",children:m?e.jsx(w,{className:"w-4 h-4 text-green-400"}):e.jsx(D,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>u(!d),className:`p-2 rounded-lg transition-colors ${d?"text-purple-400 bg-purple-600/20":"text-slate-400 hover:text-white hover:bg-slate-800"}`,title:"Members",children:e.jsx(o,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(t.roomId),className:"p-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:i?"Close Room":"Leave Room",children:e.jsx(U,{className:"w-4 h-4"})}),e.jsx("button",{onClick:h,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors hidden md:block",title:"Close",children:e.jsx(v,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t.messages.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-600 text-sm p-4 text-center",children:[e.jsx(o,{className:"w-12 h-12 mb-4 opacity-30"}),e.jsx("p",{className:"text-slate-400 mb-2",children:i?"Room created! Share the invite link to add members.":"Welcome to the room!"}),e.jsx("p",{className:"text-xs",children:"Start the conversation by sending a message."})]}):t.messages.map((s,l)=>{var N;const a=s.senderId===x,M=$(s.senderId),R=!a&&(l===0||t.messages[l-1].senderId!==s.senderId||s.timestamp-t.messages[l-1].timestamp>6e4),T=l===0||s.timestamp-t.messages[l-1].timestamp>3e5;return e.jsxs("div",{className:"space-y-1",children:[T&&e.jsx("div",{className:"flex justify-center my-4",children:e.jsx("span",{className:"text-[10px] text-slate-600 bg-slate-900/50 px-2 py-0.5 rounded-full border border-slate-800",children:y(s.timestamp,"MMM d, h:mm a")})}),e.jsxs("div",{className:`flex flex-col ${a?"items-end":"items-start"}`,children:[R&&e.jsxs("span",{className:"text-xs text-slate-500 mb-1 ml-1 flex items-center gap-1",children:[M,((N=t.members.find(O=>O.peerId===s.senderId))==null?void 0:N.isHost)&&e.jsx(c,{className:"w-3 h-3 text-yellow-500"})]}),e.jsxs("div",{className:`max-w-[85%] sm:max-w-[75%] px-4 py-2.5 rounded-2xl text-sm leading-relaxed shadow-sm break-words ${a?"bg-purple-600 text-white rounded-br-sm":"bg-slate-800 text-slate-200 border border-slate-700 rounded-bl-sm"}`,children:[s.content,e.jsx("div",{className:`text-[10px] mt-1 ${a?"text-purple-200":"text-slate-500"}`,children:y(s.timestamp,"h:mm a")})]})]})]},s.id)}),e.jsx("div",{ref:b})]}),e.jsx("div",{className:"p-3 sm:p-4 border-t border-slate-800 bg-slate-950",children:e.jsxs("form",{onSubmit:j,className:"relative flex items-end gap-2 p-2 rounded-xl border border-slate-700 bg-slate-900 focus-within:border-purple-500/50 focus-within:ring-1 focus-within:ring-purple-500/50 transition-all",children:[e.jsx("textarea",{value:r,onChange:s=>p(s.target.value),onKeyDown:S,placeholder:"Type a message...",className:"flex-1 bg-transparent border-none focus:ring-0 text-slate-200 placeholder-slate-500 resize-none py-2.5 px-2 max-h-32 text-sm outline-none",rows:1,style:{minHeight:"44px"}}),e.jsx("button",{type:"submit",disabled:!r.trim(),className:`p-2.5 rounded-lg mb-0.5 transition-all ${r.trim()?"bg-purple-600 text-white hover:bg-purple-500 shadow-lg shadow-purple-900/20":"bg-slate-800 text-slate-500 cursor-not-allowed"}`,children:e.jsx(K,{className:"w-5 h-5"})})]})})]}),d&&e.jsxs("div",{className:"w-full md:w-72 border-l border-slate-800 bg-slate-900 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold text-white flex items-center gap-2",children:[e.jsx(o,{className:"w-4 h-4 text-purple-400"}),"Members (",t.members.length,")"]}),e.jsx("button",{onClick:()=>u(!1),className:"p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors md:hidden",children:e.jsx(v,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:e.jsx("ul",{className:"space-y-1",children:t.members.sort((s,l)=>s.priority-l.priority).map(s=>{const l=s.peerId===x;return e.jsxs("li",{className:`flex items-center gap-3 p-2 rounded-lg ${l?"bg-slate-800/50":""}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${s.isHost?"bg-yellow-500/20 text-yellow-400":"bg-slate-700 text-slate-300"}`,children:(s.name||s.peerId).slice(0,2).toUpperCase()}),e.jsx("div",{className:`absolute -bottom-0.5 -right-0.5 w-2.5 h-2.5 rounded-full border-2 border-slate-900 ${s.isOnline?"bg-green-500":"bg-slate-600"}`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("span",{className:`text-sm truncate ${l?"text-slate-200 font-medium":"text-slate-300"}`,children:[s.name||s.peerId.slice(0,8),l&&e.jsx("span",{className:"text-slate-500",children:" (you)"})]}),s.isHost&&e.jsx(c,{className:"w-3 h-3 text-yellow-500 shrink-0"})]}),e.jsx("span",{className:"text-[10px] text-slate-500",children:s.isOnline?"Online":"Offline"})]})]},s.peerId)})})}),e.jsx("div",{className:"p-3 border-t border-slate-800",children:e.jsxs("button",{onClick:g,className:"w-full py-2 px-3 bg-purple-600/20 hover:bg-purple-600/30 border border-purple-500/30 text-purple-400 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[m?e.jsx(w,{className:"w-4 h-4 text-green-400"}):e.jsx(z,{className:"w-4 h-4"}),m?"Link Copied!":"Copy Invite Link"]})})]})]})};export{V as R};
