import{r as n,j as e,M as U,L as A,S as M,G as $,C as G,a as V,P as H,U as O,b as q,f as B}from"../vendor-CdBe9qih.js";import{S as K}from"./sessionswitcher-B1c3n44j.js";import{u as _,a as z,c as J}from"../index-Fs2phppL.js";const ee=()=>{const{selectedPeerId:w,setShowSettings:C,chats:S,setShowMobileDashboard:I,selectChat:o,renameChat:k}=_(),{myId:m,isReady:Q,peerError:x,isReconnecting:W,connectionStates:p,connectToPeer:P}=z(),R=Object.keys(p).filter(t=>p[t]==="connected"),[r,u]=n.useState(""),[D,i]=n.useState(!1),[h,b]=n.useState(!1),E=()=>{const t=J(m);navigator.clipboard.writeText(t),b(!0),setTimeout(()=>b(!1),2e3)},[c,d]=n.useState(null),[g,f]=n.useState(""),F=t=>{t.preventDefault(),r&&r!==m&&(P(r),o(r),u(""),i(!1))},L=(t,s)=>{t.stopPropagation(),d(s.peerId),f(s.name||s.peerId)},j=t=>{t==null||t.preventDefault(),c&&(k(c,g),d(null))},T=t=>{d(null)},N=Object.values(S).sort((t,s)=>s.lastUpdated-t.lastUpdated);return e.jsxs("div",{className:"w-full h-full bg-slate-900 border-r border-slate-800 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800 bg-slate-900/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h1",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(U,{className:"w-6 h-6 text-primary-500"}),"Ping"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>I(!0),className:"md:hidden p-2 text-slate-400 hover:text-white bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors",title:"View Dashboard",children:e.jsx(A,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>C(!0),className:"p-2 text-slate-400 hover:text-white bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors",title:"Connection Settings",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsx("a",{href:"https://github.com/HoangTran0410/chat-p2p",target:"_blank",rel:"noopener noreferrer",className:"p-2 text-slate-400 hover:text-white bg-slate-800 hover:bg-slate-700 rounded-lg transition-colors",title:"GitHub Repo",children:e.jsx($,{className:"w-5 h-5"})})]})]}),e.jsx(K,{}),x&&e.jsx("div",{className:"mt-2 text-xs text-red-400 font-medium px-1",children:x})]}),e.jsx("div",{className:"p-4",children:D?e.jsxs("form",{onSubmit:F,className:"space-y-2 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx("input",{type:"text",value:r,onChange:t=>u(t.target.value),placeholder:"Enter Peer ID...",className:"w-full bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white focus:outline-none focus:border-primary-500 transition-colors",autoFocus:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-primary-600 hover:bg-primary-500 text-white py-1.5 rounded text-sm font-medium",children:"Connect"}),e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-3 bg-slate-800 hover:bg-slate-700 text-slate-300 py-1.5 rounded text-sm",children:"Cancel"})]})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:E,className:`flex-1 py-2.5 px-4 rounded-lg flex items-center justify-center gap-2 transition-all font-medium ${h?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-slate-800 hover:bg-slate-700 text-slate-200"}`,children:h?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"w-4 h-4"}),"Invite"]})}),e.jsxs("button",{onClick:()=>i(!0),className:"flex-1 py-2.5 px-4 bg-primary-600 hover:bg-primary-500 text-white rounded-lg flex items-center justify-center gap-2 transition-all font-medium shadow-lg shadow-primary-900/20",children:[e.jsx(H,{className:"w-4 h-4"}),"New Chat"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:N.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-500 text-sm",children:[e.jsx(O,{className:"w-10 h-10 mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"No chats yet."}),e.jsx("p",{className:"mt-2 text-xs opacity-60",children:"Share your ID or enter a friend's ID to start."})]}):e.jsx("ul",{className:"space-y-1 px-2",children:N.map(t=>{const s=R.includes(t.peerId),v=w===t.peerId,l=t.messages[t.messages.length-1],y=c===t.peerId;return e.jsx("li",{children:e.jsxs("div",{className:`w-full text-left p-3 rounded-lg transition-all flex items-center gap-3 relative group ${v?"bg-slate-800 border border-slate-700 shadow-sm":"hover:bg-slate-800/50 border border-transparent"}`,children:[e.jsxs("button",{onClick:()=>o(t.peerId),className:"relative shrink-0",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold ${v?"bg-primary-600 text-white":"bg-slate-700 text-slate-300"}`,children:(t.name||t.peerId).slice(0,2).toUpperCase()}),s&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 border-2 border-slate-900 rounded-full"})]}),e.jsx("div",{className:"flex-1 min-w-0",onClick:()=>!y&&o(t.peerId),children:y?e.jsx("form",{onSubmit:j,className:"flex items-center gap-2",onClick:a=>a.stopPropagation(),children:e.jsx("input",{autoFocus:!0,value:g,onChange:a=>f(a.target.value),onBlur:()=>j(),onKeyDown:a=>{a.key==="Escape"&&T()},className:"w-full bg-slate-950 border border-primary-500/50 rounded px-1.5 py-0.5 text-sm text-white focus:outline-none"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-baseline mb-0.5",children:[e.jsx("span",{className:`font-medium text-slate-200 truncate text-sm cursor-pointer ${t.name?"":"font-mono"}`,children:t.name||t.peerId}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0 ml-2",children:[e.jsx("button",{onClick:a=>L(a,t),className:"hidden md:block text-slate-500 hover:text-primary-400 opacity-0 group-hover:opacity-100 transition-opacity",title:"Rename Contact",children:e.jsx(q,{className:"w-3 h-3"})}),l&&e.jsx("span",{className:"text-[10px] text-slate-500",children:B(l.timestamp,{addSuffix:!1}).replace("about ","")})]})]}),e.jsx("div",{className:"text-xs text-slate-400 truncate h-4 cursor-pointer",children:l?l.content:e.jsx("span",{className:"italic opacity-50",children:"No messages"})})]})})]})},t.peerId)})})})]})};export{ee as C};
