import{r as l,j as e,e as Z,A as S,g as J,h as ve,i as Q,k as ee,l as te,R as p,I as ye,X as D,m as E,n as m,o as se,C as B,p as ae,q as Ce,s as ke,U as Se,t as R,u as Ee,M as Re,v as $e,T as Me,F as Fe}from"../vendor--tW1iPYm.js";import{u as Te,M as Le,F as Ae}from"../index-D_-ulTpq.js";import{g as Ie}from"../services/storage-DVVzbgBO.js";const He=({myId:a,peerId:c,session:s,connectionState:r,onSendMessage:o,onDeleteChat:u,onConnect:x,onCancelConnection:f,isReady:w,activeConnectionsCount:le,totalChats:re,isPeerTyping:W=!1,sendMessage:$,peerError:O,onRetry:ne,onRenameChat:ie,onResendMessage:ce,onRequestSync:de,onSendFileChunked:K,sendingProgress:M,receivingProgress:v,peerFingerprint:oe,isEncrypted:y,totalRooms:xe})=>{const{backToSidebar:F}=Te(),[b,P]=l.useState(""),[ze,De]=l.useState(!1),[Be,We]=l.useState(!1),[_,me]=l.useState(null),[C,H]=l.useState(!1),[he,T]=l.useState(!1),[X,q]=l.useState(""),G=l.useRef(null),h=l.useRef(null),[k,L]=l.useState(null),[pe,A]=l.useState(!1),j=l.useRef(null),N=l.useRef(!1),ue=()=>{var t;(t=G.current)==null||t.scrollIntoView({behavior:"smooth"})};l.useEffect(()=>{ue()},[s==null?void 0:s.messages,W]);const I=t=>{$&&c&&r==="connected"&&$(c,{type:"typing",isTyping:t})},fe=t=>{const n=t.target.value;P(n),$&&r==="connected"&&(N.current||(N.current=!0,I(!0)),j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{N.current=!1,I(!1)},2e3))},V=t=>{t.preventDefault(),b.trim()&&(o(b),P(""),j.current&&clearTimeout(j.current),N.current&&(N.current=!1,I(!1)))},be=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),V(t))},je=async t=>{var d;const n=(d=t.target.files)==null?void 0:d[0];if(n){if(n.size>Le){L(n),A(!0),h.current&&(h.current.value="");return}await Y(n),h.current&&(h.current.value="")}},Y=async t=>{let n="file";if(t.type.startsWith("image/")?n="image":t.type.startsWith("video/")&&(n="video"),K&&t.size>Ae*2){const z=Ie();K(z,t,n);return}const d=await t.arrayBuffer(),U={type:n,content:t.name,file:{name:t.name,size:t.size,mimeType:t.type,data:d}};o(U)},Ne=async()=>{k&&(await Y(k),L(null)),A(!1)},ge=()=>{L(null),A(!1)},we=()=>{var t;(t=h.current)==null||t.click()};if(!c)return e.jsx("div",{className:"flex-1 flex flex-col h-full bg-slate-950 overflow-y-auto",children:e.jsxs("div",{className:"flex-1 p-6 md:p-12 max-w-4xl mx-auto w-full flex flex-col",children:[e.jsx("div",{className:"md:hidden flex items-center mb-4",children:e.jsxs("button",{onClick:F,className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[e.jsx(Z,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Back to Chats"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center py-12",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:`w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-4 ${w?"bg-green-500/10 border border-green-500/30":"bg-yellow-500/10 border border-yellow-500/30"}`,children:e.jsx(S,{className:`w-10 h-10 ${w?"text-green-500":"text-yellow-500 animate-pulse"}`})}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:w?"You're Online":"Connecting..."}),e.jsx("p",{className:"text-slate-400 text-sm max-w-md",children:w?"Your P2P connection is active. Select a chat or room to start messaging.":"Establishing secure connection to the network..."}),O&&e.jsxs("div",{className:"mt-3 flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-sm text-red-400",children:O}),e.jsx("button",{onClick:ne,className:"text-sm text-primary-400 hover:text-primary-300 underline",children:"Retry"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-center",children:[e.jsxs("div",{className:"px-6 py-4 bg-slate-900/50 border border-slate-800 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:le}),e.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mt-1",children:"Active"})]}),e.jsxs("div",{className:"px-6 py-4 bg-slate-900/50 border border-slate-800 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:re}),e.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mt-1",children:"Chats"})]}),e.jsxs("div",{className:"px-6 py-4 bg-slate-900/50 border border-slate-800 rounded-xl",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:xe}),e.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mt-1",children:"Rooms"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-6 text-xs text-slate-600 border-t border-slate-800 pt-6",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(J,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"E2E Encrypted"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ve,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Serverless"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(S,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"WebRTC"})]})]})]})});const g=(()=>{switch(r){case"connected":return{color:"bg-green-500",text:"Connected",subtext:"End-to-end encrypted",icon:e.jsx(J,{className:"w-3 h-3"})};case"connecting":return{color:"bg-yellow-500 animate-pulse",text:"Connecting...",subtext:"Waiting for peer response",icon:e.jsx(S,{className:"w-3 h-3 animate-spin"})};case"failed":return{color:"bg-red-500",text:"Connection Failed",subtext:"Peer offline or not found",icon:e.jsx(E,{className:"w-3 h-3"})};default:return{color:"bg-slate-600",text:"Disconnected",subtext:"Session offline",icon:e.jsx(te,{className:"w-3 h-3"})}}})(),i=r==="connected";return e.jsxs("div",{className:"flex-1 flex h-full bg-slate-950 relative",children:[e.jsxs("div",{className:`flex-1 flex flex-col min-w-0 ${C?"hidden md:flex":"flex"}`,children:[e.jsxs("div",{className:"h-16 border-b border-slate-800 flex items-center justify-between px-4 bg-slate-950/80 backdrop-blur-sm z-10 sticky top-0",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("button",{onClick:F,className:"md:hidden p-2 -ml-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("h2",{className:"font-semibold text-slate-100 flex items-center gap-2 truncate text-base",children:e.jsx("span",{className:`${s!=null&&s.name?"font-sans":"font-mono tracking-wide"} truncate`,children:(s==null?void 0:s.name)||c})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${g.color}`}),e.jsxs("span",{className:`${r==="failed"?"text-red-400":"text-slate-400"} flex items-center gap-1.5`,children:[(s==null?void 0:s.name)&&e.jsx("span",{className:"text-slate-500 font-mono tracking-tight mr-1 border-r border-slate-800 pr-2",children:c}),g.text]}),i&&e.jsxs("span",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[10px] font-medium ${y?"bg-primary-500/10 text-primary-400":"bg-slate-700/50 text-slate-500"}`,title:oe||(y?"E2EE Active":"Unencrypted"),children:[y?e.jsx(Q,{className:"w-2.5 h-2.5"}):e.jsx(ee,{className:"w-2.5 h-2.5"}),y?"E2EE":""]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pl-2",children:[r==="connecting"&&e.jsxs("button",{onClick:f,className:"px-3 py-1.5 bg-slate-800 hover:bg-slate-700 text-slate-300 text-xs font-medium rounded-lg transition-colors flex items-center gap-1.5",children:[e.jsx(te,{className:"w-3.5 h-3.5"}),"Cancel"]}),(r==="failed"||r==="disconnected")&&e.jsxs("button",{onClick:x,className:"px-3 py-1.5 bg-primary-600/20 hover:bg-primary-600/30 text-primary-400 text-xs font-medium rounded-lg transition-colors flex items-center gap-1.5",children:[e.jsx(p,{className:"w-3.5 h-3.5"}),"Reconnect"]}),e.jsx("button",{onClick:()=>H(!C),className:`p-2 rounded-lg transition-colors ${C?"text-primary-400 bg-primary-600/20":"text-slate-400 hover:text-white hover:bg-slate-800"}`,title:"Conversation Info",children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("button",{onClick:F,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors hidden md:block",title:"Close Chat",children:e.jsx(D,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[!s||s.messages.length===0?e.jsx("div",{className:"h-full flex flex-col items-center justify-center text-slate-600 text-sm p-4 text-center",children:r==="connecting"?e.jsxs("div",{className:"flex flex-col items-center gap-3 animate-pulse",children:[e.jsx(S,{className:"w-8 h-8 text-primary-500 opacity-50"}),e.jsx("p",{children:"Establishing secure connection..."})]}):r==="failed"?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(E,{className:"w-8 h-8 text-red-500 opacity-50"}),e.jsx("p",{className:"text-red-400/80",children:"Could not connect to peer."}),e.jsx("button",{onClick:x,className:"text-primary-500 hover:underline",children:"Try Again"})]}):e.jsx("p",{children:"No messages yet. Say hello!"})}):s.messages.map((t,n)=>{const d=t.senderId===a,U=n===0||t.timestamp-s.messages[n-1].timestamp>3e5;return e.jsxs("div",{className:"space-y-2",children:[U&&e.jsx("div",{className:"flex justify-center my-4",children:e.jsx("span",{className:"text-[10px] text-slate-600 bg-slate-900/50 px-2 py-0.5 rounded-full border border-slate-800",children:m(t.timestamp,"MMM d, h:mm a")})}),e.jsxs("div",{className:`flex flex-col ${d?"items-end":"items-start"}`,children:[e.jsxs("div",{onClick:()=>me(_===t.id?null:t.id),className:`max-w-[85%] sm:max-w-[75%] px-4 py-2.5 rounded-2xl text-sm leading-relaxed shadow-sm break-words cursor-pointer transition-all hover:opacity-90 ${d?"bg-primary-600 text-white rounded-br-sm":"bg-slate-800 text-slate-200 border border-slate-700 rounded-bl-sm"}`,children:[e.jsx(Ue,{message:t}),e.jsxs("div",{className:`text-[10px] mt-1 flex items-center gap-1 ${d?"text-primary-200":"text-slate-500"}`,children:[t.encrypted?e.jsx(Q,{className:"w-2.5 h-2.5 opacity-60"}):e.jsx(ee,{className:"w-2.5 h-2.5 opacity-40"}),m(t.timestamp,"h:mm a"),d&&t.status&&e.jsxs("span",{className:"ml-1",children:[t.status==="read"&&e.jsx(se,{className:"w-3 h-3"}),t.status==="delivered"&&e.jsx(B,{className:"w-3 h-3"}),t.status==="sent"&&e.jsx(B,{className:"w-3 h-3 opacity-50"}),t.status==="failed"&&e.jsx(E,{className:"w-3 h-3 text-red-200"})]})]})]}),d&&t.status==="failed"&&e.jsxs("button",{onClick:z=>{z.stopPropagation(),ce(t.id)},className:"text-xs text-red-400 hover:text-red-300 flex items-center gap-1 mt-1 px-1 transition-colors",children:[e.jsx(p,{className:"w-3 h-3"}),"Tap to retry"]}),_===t.id&&e.jsxs("div",{className:`mt-1 px-3 py-2 rounded-lg bg-slate-900 border border-slate-800 text-xs space-y-1 max-w-[85%] ${d?"mr-0":"ml-0"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(ae,{className:"w-3 h-3"}),e.jsxs("span",{children:["Sent:"," ",m(t.timestamp,"MMM d, yyyy h:mm:ss a")]})]}),t.receivedAt&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(B,{className:"w-3 h-3"}),e.jsxs("span",{children:["Delivered: ",m(t.receivedAt,"h:mm:ss a")]})]}),t.readAt&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(se,{className:"w-3 h-3"}),e.jsxs("span",{children:["Read: ",m(t.readAt,"h:mm:ss a")]})]})]})]})]},t.id)}),W&&e.jsx("div",{className:"flex justify-start animate-in fade-in slide-in-from-bottom-2 duration-300",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl rounded-bl-sm px-4 py-3 flex items-center gap-1 w-fit",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce [animation-delay:-0.3s]"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce [animation-delay:-0.15s]"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce"})]})}),e.jsx("div",{ref:G})]}),e.jsx("div",{className:"p-3 sm:p-4 border-t border-slate-800 bg-slate-950 safe-area-bottom",children:e.jsxs("form",{onSubmit:V,className:`relative flex items-end gap-2 p-2 rounded-xl border ${i?"border-slate-700 bg-slate-900 focus-within:border-primary-500/50 focus-within:ring-1 focus-within:ring-primary-500/50":"border-slate-800 bg-slate-900/50 opacity-75"} transition-all`,children:[e.jsx("input",{type:"file",ref:h,onChange:je,className:"hidden"}),e.jsx("button",{type:"button",onClick:we,disabled:!i,className:`p-2.5 rounded-lg mb-0.5 transition-all text-slate-400 hover:text-white hover:bg-slate-800 ${i?"":"cursor-not-allowed opacity-50"}`,title:"Attach File",children:e.jsx(Ce,{className:"w-5 h-5"})}),e.jsx("textarea",{value:b,onChange:fe,onKeyDown:be,disabled:!i,placeholder:i?"Type a message...":`Status: ${g.text}`,className:"flex-1 bg-transparent border-none focus:ring-0 text-slate-200 placeholder-slate-500 resize-none py-2.5 px-2 max-h-32 text-sm disabled:opacity-50 outline-none",rows:1,style:{minHeight:"44px"}}),e.jsx("button",{type:"submit",disabled:!b.trim()||!i,className:`p-2.5 rounded-lg mb-0.5 transition-all ${b.trim()&&i?"bg-primary-600 text-white hover:bg-primary-500 shadow-lg shadow-primary-900/20":"bg-slate-800 text-slate-500 cursor-not-allowed"}`,children:e.jsx(ke,{className:"w-5 h-5"})})]})})]}),C&&e.jsxs("div",{className:"w-full md:w-80 border-l border-slate-800 bg-slate-900 flex flex-col overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Conversation Info"}),e.jsx("button",{onClick:()=>H(!1),className:"p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors md:hidden",children:e.jsx(D,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"p-4 border-b border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${i?"bg-green-500/20":"bg-slate-700"}`,children:e.jsx(Se,{className:`w-6 h-6 ${i?"text-green-400":"text-slate-400"}`})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[he?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:X,onChange:t=>q(t.target.value),className:"flex-1 bg-slate-800 border border-slate-600 rounded px-2 py-1 text-sm text-white focus:border-primary-500 outline-none",placeholder:"Enter nickname...",autoFocus:!0}),e.jsx("button",{onClick:()=>{ie(X),T(!1)},className:"p-1 bg-primary-600 hover:bg-primary-500 text-white rounded",children:e.jsx(R,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>T(!1),className:"p-1 bg-slate-700 hover:bg-slate-600 text-white rounded",children:e.jsx(D,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-white truncate",children:(s==null?void 0:s.name)||"Peer"}),e.jsx("button",{onClick:()=>{q((s==null?void 0:s.name)||""),T(!0)},className:"p-1 text-slate-400 hover:text-white hover:bg-slate-700 rounded transition-colors",title:"Edit name",children:e.jsx(Ee,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"text-xs text-slate-400 font-mono truncate",children:c})]})]}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${i?"bg-green-500/20 text-green-400":"bg-slate-700 text-slate-400"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${g.color}`}),g.text]})]}),e.jsxs("div",{className:"p-4 border-b border-slate-800 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-400 flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"Total Messages"]}),e.jsx("span",{className:"text-white font-medium",children:(s==null?void 0:s.messages.length)||0})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-400 flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4"}),"First Message"]}),e.jsx("span",{className:"text-white font-medium",children:s!=null&&s.messages[0]?m(s.messages[0].timestamp,"MMM d, yyyy"):"-"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-400 flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Last Activity"]}),e.jsx("span",{className:"text-white font-medium",children:s!=null&&s.lastUpdated?m(s.lastUpdated,"MMM d, h:mm a"):"-"})]})]}),e.jsxs("div",{className:"p-4 space-y-2",children:[i&&e.jsxs("button",{onClick:de,className:"w-full py-2.5 px-4 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm font-medium",children:[e.jsx(p,{className:"w-4 h-4"}),"Sync History"]}),!i&&e.jsxs("button",{onClick:x,className:"w-full py-2.5 px-4 bg-primary-600 hover:bg-primary-500 text-white rounded-lg flex items-center justify-center gap-2 transition-colors text-sm font-medium",children:[e.jsx(p,{className:"w-4 h-4"}),"Reconnect"]}),e.jsxs("button",{onClick:u,className:"w-full py-2.5 px-4 bg-red-950/50 hover:bg-red-950 text-red-400 rounded-lg flex items-center justify-center gap-2 transition-colors text-sm font-medium",children:[e.jsx(Me,{className:"w-4 h-4"}),"Delete Conversation"]})]})]}),pe&&k&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl p-6 max-w-sm w-full shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-500/20 rounded-full flex items-center justify-center",children:e.jsx(E,{className:"w-6 h-6 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Large File"}),e.jsxs("p",{className:"text-sm text-slate-400",children:[(k.size/1024/1024).toFixed(1)," MB"]})]})]}),e.jsx("p",{className:"text-slate-300 mb-6 text-sm",children:"This file is larger than 50MB. Sending large files may take a while and could fail on slow connections."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ge,className:"flex-1 py-2.5 bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Ne,className:"flex-1 py-2.5 bg-primary-600 hover:bg-primary-500 text-white rounded-lg transition-colors",children:"Send Anyway"})]})]})}),M&&e.jsxs("div",{className:"fixed bottom-24 left-1/2 -translate-x-1/2 bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 shadow-xl z-40 flex items-center gap-3 min-w-[200px]",children:[e.jsx("div",{className:"animate-spin",children:e.jsx(p,{className:"w-4 h-4 text-primary-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Sending file..."}),e.jsx("div",{className:"h-1.5 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-500 transition-all duration-200",style:{width:`${M.progress}%`}})})]}),e.jsxs("span",{className:"text-sm font-medium text-white",children:[M.progress,"%"]})]}),v&&e.jsxs("div",{className:"fixed bottom-24 left-1/2 -translate-x-1/2 bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 shadow-xl z-40 flex items-center gap-3 min-w-[200px]",children:[e.jsx("div",{className:"animate-spin",children:e.jsx(p,{className:"w-4 h-4 text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-xs text-slate-400 mb-1 truncate max-w-[120px]",children:["Receiving: ",v.fileName]}),e.jsx("div",{className:"h-1.5 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 transition-all duration-200",style:{width:`${v.progress}%`}})})]}),e.jsxs("span",{className:"text-sm font-medium text-white",children:[v.progress,"%"]})]})]})},Ue=({message:a})=>{const[c,s]=l.useState(null);l.useEffect(()=>{var o;if((o=a.file)!=null&&o.data&&(a.type==="image"||a.type==="video")){const u=a.file.data instanceof Blob?a.file.data:new Blob([a.file.data]),x=URL.createObjectURL(u);return s(x),()=>URL.revokeObjectURL(x)}},[a]);const r=o=>{if(o==null||o.stopPropagation(),!a.file)return;const u=a.file.data instanceof Blob?a.file.data:new Blob([a.file.data]),x=URL.createObjectURL(u),f=document.createElement("a");f.href=x,f.download=a.file.name,f.click(),URL.revokeObjectURL(x)};return a.type==="image"&&c?e.jsxs("div",{className:"mb-2 max-w-sm relative group",children:[e.jsx("img",{src:c,alt:a.content,className:"rounded-lg border border-slate-700 w-full h-auto object-contain"}),e.jsx("button",{onClick:r,className:"absolute top-2 right-2 p-1.5 bg-black/50 hover:bg-black/70 text-white rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"Download",children:e.jsx("div",{className:"w-4 h-4",children:e.jsx(R,{className:"w-4 h-4"})})})]}):a.type==="video"&&c?e.jsxs("div",{className:"mb-2 max-w-sm relative group",children:[e.jsx("video",{src:c,controls:!0,className:"rounded-lg border border-slate-700 w-full"}),e.jsx("button",{onClick:r,className:"absolute top-2 right-2 p-1.5 bg-black/50 hover:bg-black/70 text-white rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"Download",children:e.jsx("div",{className:"w-4 h-4",children:e.jsx(R,{className:"w-4 h-4"})})})]}):a.type==="file"&&a.file?e.jsxs("div",{className:"mb-2 p-3 bg-slate-800 border border-slate-700 rounded-lg flex items-center gap-3 w-fit hover:bg-slate-750 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(Fe,{className:"w-5 h-5 text-primary-400"})}),e.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-200 truncate max-w-[150px]",children:a.file.name}),e.jsxs("p",{className:"text-xs text-slate-400",children:[(a.file.size/1024).toFixed(1)," KB"]})]}),e.jsx("button",{onClick:r,className:"p-1.5 text-slate-400 hover:text-white hover:bg-slate-600 rounded",title:"Download",children:e.jsx(R,{className:"w-4 h-4"})})]}):e.jsx("div",{className:"text-sm border-b border-slate-800/50 pb-2 mb-2 whitespace-pre-wrap",children:a.content})};export{He as C};
